{
  "version": 3,
  "sources": ["../../../../../node_modules/@cfpb/cfpb-analytics/src/cfpb-analytics.js", "../../../../unprocessed/apps/analytics-gtm/js/retirement-before-you-claim-listeners.js"],
  "sourcesContent": ["/**\n * Log a message to the console if the `debug-gtm` URL parameter is set.\n * @param {string} msg - Message to load to the console.\n */\nfunction analyticsLog(...msg) {\n  // Check if URLSearchParams is supported (Chrome > 48; Edge > 16).\n  if (typeof window.URLSearchParams === 'function') {\n    // Get query params.\n    const queryParams = new URLSearchParams(window.location.search);\n    if (queryParams.get('debug-gtm') === 'true') {\n      // eslint-disable-next-line no-console\n      console.log(`ANALYTICS DEBUG MODE: ${msg}`);\n    }\n  }\n}\n\nlet loadTryCount = 0;\n\n/**\n * @returns {boolean} Whether GTM has been loaded or not.\n */\nfunction _isGtmLoaded() {\n  window.dataLayer = window.dataLayer || [];\n  const gtmStartedEvent = window.dataLayer.find(\n    (element) => element['gtm.start'],\n  );\n\n  if (!gtmStartedEvent) {\n    // Not even the GTM inline config has executed.\n    return false;\n  } else if (!gtmStartedEvent['gtm.uniqueEventId']) {\n    // GTM inline config has run, but the main GTM JS has not loaded.\n    return false;\n  }\n\n  // GTM is fully loaded and working.\n  return true;\n}\n\n/**\n * Poll every 0.5 seconds for 10 seconds for if Google Tag Manager has loaded.\n * @returns {Promise} Resolves if Google Tag Manager has loaded.\n *   Rejects if polling has completed.\n */\nfunction ensureGoogleTagManagerLoaded() {\n  return new Promise(function (resolve, reject) {\n    (function waitForGoogleTagManager() {\n      if (_isGtmLoaded()) return resolve();\n      if (++loadTryCount > 9) return reject();\n      setTimeout(waitForGoogleTagManager, 500);\n    })();\n  });\n}\n\n/**\n * @name analyticsSendEvent\n * @kind function\n * @description\n *   Pushes an event to the GTM dataLayer.\n *   This can accept arbitrary values, but traditionally (pre-GA4) would accept\n *   event, action, and label. Th eventCallback and eventTimeout values can also\n *   be sent, which are called if there's an issue loading GTM.\n * @param {object} payload - A list or a single event.\n * @param {string} payload.event - Type of event.\n * @param {string} payload.action - Name of event.\n * @param {string} payload.label - DOM element label.\n * @param {Function} [payload.eventCallback] - Function to call on GTM submission.\n * @param {number} [payload.eventTimeout] - Callback invocation fallback time.\n * @returns {Promise} Resolves if the event is sent,\n *   otherwise calls the callback if provided.\n */\nfunction analyticsSendEvent(payload) {\n  return ensureGoogleTagManagerLoaded()\n    .then(() => {\n      // GTM should be loaded at this point.\n      const printPayload = [];\n      Object.entries(payload).forEach(([key, value]) => {\n        printPayload.push(`(${key}: ${value})`);\n      });\n\n      analyticsLog(`Sending \"${printPayload.join(', ')}\"`);\n      window.dataLayer.push(payload);\n    })\n    .catch(() => {\n      if (\n        payload.eventCallback &&\n        typeof payload.eventCallback === 'function'\n      ) {\n        // eslint-disable-next-line callback-return\n        payload.eventCallback();\n      }\n    });\n}\n\nexport { analyticsSendEvent, analyticsLog };\n", "import { analyticsSendEvent, analyticsLog } from '@cfpb/cfpb-analytics';\n\n// Retirement - Before You Claim custom analytics file\n\n(function () {\n  const questionsAnswered = [];\n  let sliderClicks = 0;\n  let sliderIsActive = false;\n  let stepOneSubmitted = false;\n\n  /**\n   * @param {number} month - Month of birth.\n   * @param {number} day - Day of birth.\n   * @param {number} year - Year of birth.\n   * @returns {number} The age, in years, based on current date.\n   */\n  function calculateAge(month, day, year) {\n    const now = new Date();\n    const birthdate = new Date(year, Number(month) - 1, day);\n    let age = now.getFullYear() - birthdate.getFullYear();\n    const m = now.getMonth() - birthdate.getMonth();\n    if (m < 0 || (m === 0 && now.getDate() < birthdate.getDate())) {\n      age--;\n    }\n    if (isNaN(age)) {\n      return false;\n    }\n    return age;\n  }\n\n  const stepOneForm = document.querySelector('#step-one-form');\n  stepOneForm.addEventListener('submit', formSubmitted);\n\n  /**\n   * Handle submission of the form.\n   * @param {Event} evt - Form submit event object.\n   */\n  function formSubmitted(evt) {\n    evt.preventDefault();\n    stepOneSubmitted = true;\n\n    // Track birthdate.\n    const month = document.querySelector('#bd-month').value;\n    const day = document.querySelector('#bd-day').value;\n    analyticsSendEvent({\n      event: 'Before You Claim Interaction',\n      action: 'Get Your Estimates submit birthdate',\n      label: 'Birthdate Month and Day - ' + month + '/' + day,\n    });\n\n    // Track age.\n    const year = document.querySelector('#bd-year').value;\n    const age = calculateAge(month, day, year);\n    analyticsSendEvent({\n      event: 'Before You Claim Interaction',\n      action: 'Get Your Estimates submit age',\n      label: 'Age ' + age,\n    });\n\n    // Start mouseflow heatmap capture.\n    if (window.mouseflow) {\n      // Stop any in-progress heatmap capturing.\n      window.mouseflow.stop();\n      // Start a new heatmap recording.\n      window.mouseflow.start();\n      analyticsLog('Mouseflow capture started!');\n    }\n\n    document\n      .querySelector('#claim-canvas')\n      .addEventListener('mousedown', function (event) {\n        if (event.target.classList.contains('graph--bar')) {\n          const age = event.target.getAttribute('data-bar_age');\n          analyticsSendEvent({\n            event: 'Before You Claim Interaction',\n            action: 'Graph Age Bar clicked',\n            label: 'Age ' + age,\n          });\n        }\n      });\n\n    document\n      .querySelector('#graph__slider-input')\n      .addEventListener('mousedown', function () {\n        sliderIsActive = true;\n        sliderClicks++;\n        analyticsSendEvent({\n          event: 'Before You Claim Interaction',\n          action: 'Slider clicked',\n          label: 'Slider clicked ' + sliderClicks + ' times',\n        });\n      });\n\n    document\n      .querySelector('#claim-canvas')\n      .addEventListener('click', function (event) {\n        const target = event.target.parentNode;\n        if (target.classList.contains('age-text')) {\n          const age = target.getAttribute('data-age-value');\n          analyticsSendEvent({\n            event: 'Before You Claim Interaction',\n            action: 'Age Text Box clicked',\n            label: 'Age ' + age,\n          });\n        }\n      });\n\n    document.body.addEventListener('mouseup', function () {\n      if (sliderIsActive === true) {\n        const age = document.querySelector('.selected-age').innerText;\n        analyticsSendEvent({\n          event: 'Before You Claim Interaction',\n          action: 'Slider released',\n          label: 'Age ' + age,\n        });\n        sliderIsActive = false;\n      }\n    });\n\n    const lifestyleBtns = document.querySelectorAll('button.lifestyle-btn');\n    for (let i = 0, len = lifestyleBtns.length; i < len; i++) {\n      lifestyleBtns[i].addEventListener('click', function (event) {\n        const target = event.currentTarget;\n        const $container = target.closest('.lifestyle-question__container');\n        const question = $container.querySelector('h3').innerText.trim();\n        const value = target.value;\n        if (questionsAnswered.indexOf(question) === -1) {\n          questionsAnswered.push(question);\n        }\n        if (questionsAnswered.length === 5) {\n          analyticsSendEvent({\n            event: 'Before You Claim Interaction',\n            action: 'All Lifestyle Buttons clicked',\n            label: 'All button clicks',\n          });\n        }\n        analyticsSendEvent({\n          event: 'Before You Claim Interaction',\n          action: 'Lifestyle Button clicked',\n          label: 'Question: ' + question + ' - ' + value,\n        });\n      });\n    }\n\n    const benefitsRadios = document.querySelectorAll(\n      'input[name=\"benefits-display\"]',\n    );\n    for (let i = 0, len = benefitsRadios.length; i < len; i++) {\n      benefitsRadios[i].addEventListener('click', function (event) {\n        if (stepOneSubmitted) {\n          const val = event.currentTarget.value;\n          analyticsSendEvent({\n            event: 'Before You Claim Interaction',\n            action: 'Benefits View clicked',\n            label: val,\n          });\n        }\n      });\n    }\n\n    document\n      .querySelector('#retirement-age-selector')\n      .addEventListener('change', function (event) {\n        const target = event.currentTarget;\n        const val = target[target.selectedIndex].value;\n        analyticsSendEvent({\n          event: 'Before You Claim Interaction',\n          action: 'Planned Retirement Age selected',\n          label: val,\n        });\n      });\n\n    document\n      .querySelector('[data-tooltip-target]')\n      .addEventListener('click', function (event) {\n        const target = event.currentTarget.getAttribute('data-tooltip-target');\n        analyticsSendEvent({\n          event: 'Before You Claim Interaction',\n          action: 'Tooltip clicked',\n          label: 'Target: ' + target,\n        });\n      });\n  }\n})();\n"],
  "mappings": "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",
  "names": ["analyticsLog", "msg", "loadTryCount", "_isGtmLoaded", "gtmStartedEvent", "element", "ensureGoogleTagManagerLoaded", "resolve", "reject", "waitForGoogleTagManager", "analyticsSendEvent", "payload", "printPayload", "key", "value", "questionsAnswered", "sliderClicks", "sliderIsActive", "stepOneSubmitted", "calculateAge", "month", "day", "year", "now", "birthdate", "age", "m", "formSubmitted", "evt", "analyticsSendEvent", "analyticsLog", "event", "target", "lifestyleBtns", "i", "len", "question", "value", "benefitsRadios", "val"]
}
