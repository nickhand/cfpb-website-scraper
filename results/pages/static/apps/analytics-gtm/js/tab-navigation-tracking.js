(()=>{var x;function T(t,e,n){return n=m(n),n.setItem?n.setItem(t,e):n[t]=e,e}function h(t,e){return e=m(e),e.getItem?e.getItem(t):e[t]}function N(t,e){e=m(e);let n=!0;return h(t,e)||(n=!1),n&&(e.removeItem?e.removeItem(t):delete e[t]),n}function R(t){if(typeof t!="object")throw new Error("Setting must be an object.");x=t}function m(t){if(t===null||typeof t!="object")if(typeof x=="undefined")try{t=window.sessionStorage}catch(e){t={}}else t=x;return t}var a={setItem:T,getItem:h,removeItem:N,setStorage:R};var f,u;try{f=window.localStorage,u=window.sessionStorage}catch(t){f=null,u=null}(()=>{if(!window.Storage||f===null||u===null)return;let t=!0,e=JSON.parse(a.getItem("_tab_ids",f)),n=a.getItem("_tab_id",u),i=JSON.parse(a.getItem("_nav_path",u)),r=document.location.href,d=!1,I=document.location.origin,p,l,g,s;function _(){return t===!1?"BACK/FORWARD":i.length<2?"FORWARD":(g=i[i.length-2],s=i[i.length-1],g===r||s===r?"BACK":"FORWARD")}function S(){let o;e=JSON.parse(a.getItem("_tab_ids",f)),n=a.getItem("_tab_id",u),e!==null&&n!==null&&(o=e.indexOf(n),o>-1&&e.splice(o,1),a.setItem("_tab_ids",JSON.stringify(e),f))}function v(){let o=new Date().getTime();return typeof performance!="undefined"&&typeof performance.now=="function"&&(o+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,c=>{let b=(o+Math.random()*16)%16|0;return o=Math.floor(o/16),(c==="x"?b:b&3|8).toString(16)})}function y(o,c){return!(c===!0&&o!==0&&o!==255)}n===null&&(n=v(),d=!0,a.setItem("_tab_id",n,u)),e=e||[],e.indexOf(n)===-1&&(e.push(n),a.setItem("_tab_ids",JSON.stringify(e),f));let O=e.length;if(window.PerformanceNavigation){i=i||[],p=window.performance.navigation.redirectCount;let o=window.performance.navigation.type;if(y(o,d))switch(o){case 0:l="NAVIGATE",i.push(r);break;case 1:l="RELOAD",(i.length===0||i[i.length-1]!==r)&&i.push(r);break;case 2:l=_(),l==="FORWARD"?document.referrer.indexOf(I)>-1&&i.push(r):l==="BACK"?s!==r&&i.pop():i.push(r);break;default:l="OTHER",i.push(r)}else i.push(r);try{a.setItem("_nav_path",JSON.stringify(i),sessionStorage)}catch(c){console.log(c)}}window.addEventListener("beforeunload",S);let w={tabCount:O,redirectCount:p,navigationType:l,newTab:d===!0?"New":"Existing",tabId:n};window.google_tag_manager["GTM-KMMLRS"].dataLayer.set("browsingBehavior",w),window.dataLayer.push({event:"custom.navigation",browsingBehavior:w})})();})();
//# sourceMappingURL=tab-navigation-tracking.js.map
