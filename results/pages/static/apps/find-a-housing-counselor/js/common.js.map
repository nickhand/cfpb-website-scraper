{
  "version": 3,
  "sources": ["../../../../unprocessed/apps/find-a-housing-counselor/js/hud-util.js", "../../../../unprocessed/apps/find-a-housing-counselor/js/common.js"],
  "sourcesContent": ["let UNDEFINED;\n\n/* checkHudData() just makes sure your data has the correct structure\nbefore you start requesting properties that don't exist in _updateMap()\n*/\n\n/**\n * Make sure your data has the correct structure\n * before you start requesting properties that don't exist in updateMap()\n * @param {object} data - The data object to check for a valid structure.\n * @returns {boolean} True if the data object is valid, false otherwise.\n */\nfunction checkHudData(data) {\n  if (data === null || data === 0 || data === UNDEFINED) {\n    return false;\n  } else if (\n    {}.hasOwnProperty.call(data, 'error') ||\n    !{}.hasOwnProperty.call(data, 'counseling_agencies') ||\n    !{}.hasOwnProperty.call(data, 'zip')\n  ) {\n    return false;\n  }\n\n  return true;\n}\n\nexport { checkHudData };\n", "import { checkHudData } from './hud-util.js';\n\nconst MAPBOX_JS_URL = 'https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js';\nconst MAPBOX_CSS_URL = 'https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css';\n\n// Settings stored in the template from the backend.\nconst mapboxAccessToken = window.cfpbHudSettings.mapbox_access_token;\nconst hudData = window.cfpbHudSettings.hud_data;\n\n/* This script uses a local Django API to acquire a list of the 10 closest\nHUD Counselors by zip code. See hud_api_replace for more details on the\nAPI queries. -wernerc */\n\n// Set up print results list button functionality, if it exists.\nconst printPageLink = document.getElementById('hud_print-page-link');\nif (printPageLink) {\n  printPageLink.addEventListener('click', (evt) => {\n    evt.preventDefault();\n    window.print();\n  });\n}\n\nlet map;\nlet markerArray = [];\nlet zipMarker = null;\nlet markerDomCache = {};\n\n/**\n * Dynamically add mapbox CSS to document head.\n */\nfunction injectMapboxCSS() {\n  const mapStyles = document.createElement('link');\n  mapStyles.rel = 'stylesheet';\n  mapStyles.href = MAPBOX_CSS_URL;\n  document.head.appendChild(mapStyles);\n}\n\n/**\n * Dynamically add mapbox JavaScript to document head.\n */\nfunction injectMapboxJS() {\n  const mapScript = document.createElement('script');\n  mapScript.addEventListener('load', scriptLoaded);\n  mapScript.async = true;\n  mapScript.src = MAPBOX_JS_URL;\n  document.head.appendChild(mapScript);\n}\n\n/**\n * Event handler for successful load of mapbox JavaScript file.\n * @param {Event} evt - The event object from the load event.\n */\nfunction scriptLoaded(evt) {\n  evt.target.removeEventListener('load', scriptLoaded);\n  initializeMap();\n}\n\n/**\n * Set access map options and create map.\n */\nfunction initializeMap() {\n  const showMap = Boolean(document.getElementById('hud-hca-api-map-container'));\n\n  if (showMap) {\n    const fcm = document.getElementById('hud_search_container');\n    fcm.classList.remove('no-js');\n    window.L.mapbox.accessToken = mapboxAccessToken;\n    map = window.L.mapbox\n      .map('hud-hca-api-map-container')\n      .setView([40, -80], 2)\n      .addLayer(\n        window.L.mapbox.styleLayer('mapbox://styles/mapbox/streets-v11'),\n      );\n\n    if (hudData.counseling_agencies) {\n      updateMap(hudData);\n    }\n  }\n}\n\n/**\n * Cache the map marker result item DOM references so that a DOM lookup doesn't\n * happen every time a map marker is clicked. The lookup happens on the first\n * click and then is stored in the markerDomCache object.\n * @param {number} num - The index of the result item.\n * @returns {HTMLElement} The DOM node of the result item.\n */\nfunction queryMarkerDom(num) {\n  const id = 'hud-result-' + Number.parseInt(num, 10);\n  let cachedItem = markerDomCache[id];\n  if (typeof cachedItem === 'undefined') {\n    cachedItem = document.getElementById(id);\n    markerDomCache[id] = cachedItem;\n  }\n\n  return cachedItem;\n}\n\n/**\n * Takes the data and plots the markers, etc, on the map.\n * @param {object} data - data returned from the API.\n */\nfunction updateMap(data) {\n  // reset the map\n  markerDomCache = {};\n  for (let i = 0; i < markerArray.length; i++) {\n    map.removeLayer(markerArray[i]);\n  }\n  markerArray = [];\n  if (zipMarker !== null) {\n    map.removeLayer(zipMarker);\n  }\n  map.setZoom(2);\n  map.setView([40, -80]);\n\n  if (checkHudData(data) === true) {\n    const lat = data.zip.lat;\n    const lng = data.zip.lng;\n    const ziplatlng = [lat, lng];\n    const zoom = 14;\n\n    map.setZoom(zoom);\n    map.setView(ziplatlng);\n\n    let xmax = -Infinity;\n    let xmin = Infinity;\n    let ymax = -Infinity;\n    let ymin = Infinity;\n\n    zipMarker = window.L.circle(ziplatlng, 3).addTo(map);\n\n    data.counseling_agencies.forEach((val, i) => {\n      const lat = val.agc_ADDR_LATITUDE;\n      const lng = val.agc_ADDR_LONGITUDE;\n      const position = new window.L.LatLng(lat, lng);\n\n      if (lat > ymax) ymax = lat;\n      if (lat < ymin) ymin = lat;\n      if (lng > xmax) xmax = lng;\n      if (lng < xmin) xmin = lng;\n\n      let number = i + 1;\n\n      if (number < 10) {\n        number = '0' + number;\n      }\n\n      const icon = window.L.icon({\n        iconUrl:\n          '/static/apps/find-a-housing-counselor/img/hud_gmap/agc_' +\n          number +\n          '.png',\n        iconAnchor: [14, 32],\n        iconSize: [27, 32],\n      });\n\n      const marker = new window.L.Marker(position, { icon: icon }).addTo(map);\n      markerArray[i] = marker;\n\n      marker.on('click', function () {\n        const resultEntryDom = queryMarkerDom(number);\n        resultEntryDom.scrollIntoView({\n          behavior: 'smooth',\n          block: 'start',\n        });\n      });\n    });\n\n    // shift the max bounds so that the dropped pins are always on screen\n    const xd = (xmax - xmin) / 10;\n    const yd = (ymax - ymin) / 10;\n\n    map.fitBounds([\n      [ymin - yd, xmin - xd],\n      [ymax + yd, xmax + xd],\n    ]);\n  }\n}\n\n// Get started by injecting the Mapbox CSS and JavaScript in the document head\u2026\ninjectMapboxCSS();\ninjectMapboxJS();\n"],
  "mappings": "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",
  "names": ["UNDEFINED", "checkHudData", "data", "MAPBOX_JS_URL", "MAPBOX_CSS_URL", "mapboxAccessToken", "hudData", "printPageLink", "evt", "map", "markerArray", "zipMarker", "markerDomCache", "injectMapboxCSS", "mapStyles", "injectMapboxJS", "mapScript", "scriptLoaded", "initializeMap", "updateMap", "queryMarkerDom", "num", "id", "cachedItem", "data", "i", "checkHudData", "lat", "lng", "ziplatlng", "xmax", "xmin", "ymax", "ymin", "val", "position", "number", "icon", "marker", "xd", "yd"]
}
